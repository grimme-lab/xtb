#include <math.h>
#include <stdbool.h>
#include <stddef.h>
#include <stdlib.h>
#include <stdio.h>

#include "xtb.h"

#define check(x, ...)                                                          \
  _Generic((x), int : check_int, double : check_double)(x, __VA_ARGS__)

static inline bool check_int(int actual, int expected, const char *msg) {
  if (expected == actual) {
    return true;
  }
  fprintf(stderr, "FAIL: %s: expected %d, got %d\n", msg, expected, actual);
  return false;
}

static inline bool check_double(double actual, double expected, double tol,
                                const char *msg) {
  if (fabs(expected - actual) < tol) {
    return true;
  }
  fprintf(stderr, "FAIL: %s: expected %g, got %g\n", msg, expected, actual);
  return false;
}

int simpleTest() {
  // first molecule
  double* q;
  char* buffer;
  double* wbo;

  int buffersize = 512;
  int tester = 0;
  int const natoms = 7;
  int const natsq = 49;
  int const attyp[7] = {6, 6, 6, 1, 1, 1, 1};
  double const coord[3 * 7] = {
      +0.00000000000000, +0.00000000000000, -1.79755622305860,
      +0.00000000000000, +0.00000000000000, +0.95338756106749,
      +0.00000000000000, +0.00000000000000, +3.22281255790261,
      -0.96412815539807, -1.66991895015711, -2.53624948351102,
      -0.96412815539807, +1.66991895015711, -2.53624948351102,
      +1.92825631079613, +0.00000000000000, -2.53624948351102,
      +0.00000000000000, +0.00000000000000, +5.23010455462158};

  xtb_TEnvironment env = NULL;
  xtb_TMolecule mol = NULL;
  xtb_TCalculator calc = NULL;
  xtb_TResults res = NULL;
  double energy;
  double dipole[3];
  q = (double*) malloc(natoms * sizeof(double));
  wbo = (double*) malloc(natsq * sizeof(double));
  buffer = (char*) malloc(buffersize *sizeof(char));
  char solvent[] = "h2o";

  if (!check(XTB_API_VERSION, xtb_getAPIVersion(), "API version does not match"))
     goto error;

  env = xtb_newEnvironment();
  calc = xtb_newCalculator();
  res = xtb_newResults();
  mol = xtb_newMolecule(env, &natoms, attyp, coord, NULL, NULL, NULL, NULL);
  if (xtb_checkEnvironment(env))
    goto error;

  xtb_getEnergy(env, res, &energy);
  if (xtb_checkEnvironment(env)) {
    xtb_getError(env, buffer, &buffersize);
    printf("Error message is:\n%s\n", buffer);
  }

  xtb_setVerbosity(env, XTB_VERBOSITY_FULL);
  if (xtb_checkEnvironment(env))
    goto error;

  xtb_loadGFN2xTB(env, mol, calc, NULL);
  xtb_setAccuracy(env, calc, 1.0);
  xtb_setElectronicTemp(env, calc, 300.0);
  xtb_setMaxIter(env, calc, 30);
  if (xtb_checkEnvironment(env))
    goto error;

  xtb_singlepoint(env, mol, calc, res);
  if (xtb_checkEnvironment(env))
    goto error;

  xtb_getEnergy(env, res, &energy);
  xtb_getCharges(env, res, q);
  xtb_getDipole(env, res, dipole);
  xtb_getBondOrders(env, res, wbo);
  if (xtb_checkEnvironment(env))
    goto error;

  if (!check(energy, -8.3824793849585, 1.0e-9, "Energy does not match"))
    goto error;
  if (!check(q[5], 0.05184019996829, 1.0e-8, "Charge does not match"))
    goto error;
  if (!check(dipole[2], -0.298279305689518, 1.0e-6, "Dipole does not match"))
    goto error;
  if (!check(wbo[9], 2.89823984265213, 1.0e-8, "Bond order does not match"))
    goto error;

  xtb_setSolvent(env, calc, solvent, NULL, NULL, NULL);
  if (xtb_checkEnvironment(env))
    goto error;

  xtb_singlepoint(env, mol, calc, res);
  if (xtb_checkEnvironment(env))
    goto error;

  xtb_getEnergy(env, res, &energy);
  xtb_getCharges(env, res, q);
  xtb_getDipole(env, res, dipole);
  xtb_getBondOrders(env, res, wbo);
  if (xtb_checkEnvironment(env))
    goto error;

  if (!check(energy, -8.38393864716134, 1.0e-9, "Energy does not match"))
    goto error;
  if (!check(q[5], 0.06090868805034, 1.0e-8, "Charge does not match"))
    goto error;
  if (!check(dipole[2], -0.35455233974705, 1.0e-6, "Dipole does not match"))
    goto error;
  if (!check(wbo[9], +2.89453979224265, 1.0e-8, "Bond order does not match"))
    goto error;

  xtb_delete(res);
  xtb_delete(calc);
  xtb_delete(mol);
  xtb_delete(env);

  free(q);
  free(wbo);
  free(buffer);

  tester = !res;
  if (!check(tester, 1, "Results not deleted"))
    goto error;
  tester = !calc;
  if (!check(tester, 1, "Calculator not deleted"))
    goto error;
  tester = !mol;
  if (!check(tester, 1, "Molecule not deleted"))
    goto error;
  tester = !env;
  if (!check(tester, 1, "Environment not deleted"))
    goto error;

  return 0;

error:
  xtb_showEnvironment(env, NULL);
  xtb_delete(res);
  xtb_delete(calc);
  xtb_delete(mol);
  xtb_delete(env);
  return 1;
}

int smallEmbeddingTestGFN1() {
  // second molecule

  int const natoms = 31;
  int const npc = 32;
  double const charge = 0.0;
  int const uhf = 0;

  int const attyp[31] = {1, 6, 1, 1, 6, 1, 6, 1, 1, 1, 6, 1, 6, 1, 1, 6,
                         1, 1, 6, 1, 6, 1, 1, 1, 6, 1, 1, 6, 1, 8, 1};

  double const coord[3 * 31] = {
      -0.442947496, 11.001947210, 23.53843018,  -2.236268461, 11.818985980,
      22.93889444,  -1.841717705, 13.792091510, 22.49830981,  -2.896722482,
      10.768954200, 21.29444454,  -4.133665133, 11.695821690, 25.11713090,
      -4.513283393, 9.713842463,  25.52960654,  -6.643232696, 12.675979330,
      24.06753249,  -6.497152995, 14.672778630, 23.58352390,  -8.148942688,
      12.705927690, 25.47277389,  -7.353363183, 11.592564650, 22.46591770,
      -3.249632431, 12.876986410, 27.66935330,  -4.846956553, 12.734322190,
      28.99201199,  -2.467110848, 15.660343880, 27.33890614,  -4.009123687,
      16.787220770, 26.56744596,  -0.818133300, 15.913359350, 26.13075930,
      -1.719833938, 16.708905520, 29.92782456,  -1.175383185, 18.674510890,
      29.63963875,  -3.270175176, 16.843998070, 31.30603239,  0.393734165,
      15.240980550, 31.24575662,  2.098110773,  15.276181590, 30.05626854,
      1.103721260,  16.300985820, 33.84032285,  -0.510552700, 16.227748650,
      35.11752635,  1.786206150,  18.232492740, 33.62584759,  2.541275947,
      15.177545230, 34.79620160,  -0.431661103, 12.490133300, 31.57724434,
      1.201728308,  11.377478740, 32.22095010,  -1.982252711, 12.263731930,
      32.94292201,  -1.094745099, 11.448025710, 28.96323675,  0.563579412,
      11.458509150, 27.70991388,  -1.947354387, 8.933606299,  29.46637609,
      -0.489290309, 7.918137207,  29.92393411};

  // external point charges
  double const pc[32] = {0.431000, -0.664000, 0.173000, 0.020000, 0.020000, 0.020000,
                         0.431000, -0.664000, 0.173000, 0.020000, 0.020000, 0.020000,
                         0.431000, -0.664000, 0.173000, 0.020000, 0.020000, 0.020000,
                         0.431000, -0.664000, 0.173000, 0.020000, 0.020000, 0.020000,
                         0.431000, -0.664000, 0.173000, 0.020000, 0.020000, 0.020000,
                         0.431000, -0.664000};

  // coordinates of point charges
  double const pccoord[3 * 32] = {
      -1.696669514,  28.11745897,  55.50995136,   -0.967547429, 28.88443423,
      54.00850230,   -0.950868672, 31.58534217,   53.92332839,  0.439341438,
      32.17158366,   52.52085582,  -0.346867500,  32.42710162,  55.70375073,
      -2.886638164,  32.14280874,  53.49308978,   26.383000520, 21.74765157,
      24.17099786,   27.036716710, 22.30632379,   22.54790876,  26.261114830,
      20.54528062,   20.65041197,  27.011658890,  18.66770536,  21.04304684,
      24.203790340,  20.57032899,  20.55244459,   26.920273440, 21.10742805,
      18.78164663,   25.713072340, 18.66022959,   28.70604561,  26.111998120,
      18.26958272,   26.95615185,  27.664033370,  16.09612865,  26.54280365,
      29.614523860,  16.44665278,  27.10468085,   26.659753370, 14.55538454,
      27.47032282,   27.860595530, 15.78003352,   24.51695451,  12.692343200,
      -11.99272547,  35.30000333,  11.005978380,  -11.84086488, 36.01217832,
      9.538990432,   -10.94052003, 33.92895508,   10.179104340, -11.53047861,
      32.06199633,   9.248569167,  -8.901943552,  33.87774529,  7.688508235,
      -11.83241211,  34.08195518,  -11.936904730, 22.39399025,  52.97048306,
      -10.467911780, 21.31627534,  53.20385904,   -8.951231490, 21.02794412,
      50.98626089,   -8.320084347, 22.92510643,   50.49100234,  -10.224293460,
      20.31250935,   49.53331363,  -7.443136243,  19.66216255,  51.30727310,
      15.373924870,  30.20492464,  53.87317117,   15.097532960, 31.53390939,
      52.63558511};

  int const numbers[32] = {7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
                           7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7};

  // results will live in here
  double energy = 0.0;
  double grad[3 * 31] = {
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0};
  double pcgrad[3 * 32] = {
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0};

  xtb_TEnvironment env = xtb_newEnvironment();
  xtb_TCalculator calc = xtb_newCalculator();
  xtb_TResults res = xtb_newResults();
  xtb_TMolecule mol =
      xtb_newMolecule(env, &natoms, attyp, coord, &charge, &uhf, NULL, NULL);
  if (xtb_checkEnvironment(env))
    goto error;

  xtb_setVerbosity(env, XTB_VERBOSITY_FULL);
  if (xtb_checkEnvironment(env))
    goto error;

  xtb_loadGFN1xTB(env, mol, calc, NULL);
  if (xtb_checkEnvironment(env))
    goto error;

  xtb_setExternalCharges(env, calc, &npc, numbers, pc, pccoord);
  if (xtb_checkEnvironment(env))
    goto error;

  xtb_singlepoint(env, mol, calc, res);
  if (xtb_checkEnvironment(env))
    goto error;

  xtb_getEnergy(env, res, &energy);
  if (xtb_checkEnvironment(env))
    goto error;

  xtb_getGradient(env, res, grad);
  if (xtb_checkEnvironment(env))
    goto error;
  
  xtb_getPCGradient(env, res, pcgrad);
  if (xtb_checkEnvironment(env))
    goto error;

  xtb_releaseExternalCharges(env, calc);
  if (xtb_checkEnvironment(env))
    goto error;

  xtb_delete(res);
  xtb_delete(calc);
  xtb_delete(mol);
  xtb_delete(env);

  if (!check(energy, -36.669823427277, 1.0e-9, "Energy does not match"))
    goto error;

  if (!check(grad[0], -0.001992796604, 1.0e-8, "grad[0] does not match"))
    goto error;
  if (!check(grad[92], 0.000601316395, 1.0e-8, "grad[92] does not match"))
    goto error;
  
  if (!check(pcgrad[0], 0.000000366847, 1.0e-8, "pcgrad[0] does not match"))
    goto error;
  if (!check(pcgrad[95], 0.000000720813, 1.0e-8, "pcgrad[95] does not match"))
    goto error;

  return 0;

error:
  xtb_showEnvironment(env, NULL);
  xtb_delete(res);
  xtb_delete(calc);
  xtb_delete(mol);
  xtb_delete(env);
  return 1;
}

int bigEmbeddingTestGFN2() {
  // many point charges

  int const natoms = 12;
  int const attyp[12] = {1, 6, 6, 1, 6, 1, 6, 1, 6, 1, 6, 1};
  double const charge = 0.0;
  int const uhf = 0;
  double const coord[3 * 12] = {
      5.43247750752583691281,   16.30179782945970856645,
      -16.80834679133825559916, 4.20707827437700387918,
      15.63010574911607974968,  -15.29509065964696823414,
      4.74062117212199307659,   16.51080889759003156314,
      -12.87869179877432479486, 5.92956271720048277984,
      18.17602242727858197213,  -12.64255124466860991106,
      3.59752895534008487743,   15.37022130591465618465,
      -10.80718578093908099902, 3.78211549254786216778,
      16.01603510734593527332,  -8.85999043798200069944,
      2.13030356572564594231,   13.22566377601445175571,
      -11.19078527600406047782, 1.51672013333912825139,
      12.14842162452260687644,  -9.54585913597908231054,
      1.61278071420337609787,   12.27967526933332109706,
      -13.58594370125686445760, 0.32262734396997649888,
      10.69255615795849045924,  -13.82873909863807604381,
      2.67539205218669717823,   13.52458030110908104859,
      -15.64023748197673313598, 2.75193965346188518240,
      12.35888379502510581176,  -17.33660147738847712162};

  int npc = 378;

  // external point charges
  double pc[378] = {
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800,
      -0.847600, 0.423800, 0.423800, -0.847600, 0.423800, 0.423800};

  // coordinates of point charges
  double pccoord[3 * 378] = {-6.70516148661034527834,  10.44008490542861800066,
                             -23.43162087543487359653, -6.34477615240269443575,
                             9.18357628921891944174,   -22.06676890718984651585,
                             -7.36149416924772737048,  12.03593168259391354979,
                             -22.66091574274770437114, 13.67009359817225622180,
                             17.48514236257433651645,  -21.58336065248489532564,
                             15.06746009369265770772,  17.92918904260767121173,
                             -20.39101344162728679521, 14.08688055225378121804,
                             15.86760148305765305565,  -22.46730284951916445380,
                             10.69796055006169943624,  5.64968184558285813068,
                             -13.05950462699626690721, 10.24729557407067837005,
                             7.04799284549403992628,   -11.87095446325143299759,
                             9.36437396183129600047,   4.31248682387934412219,
                             -12.99267226277786235755, -4.85442264119567568059,
                             4.90572602361780685243,   1.60157501176355077099,
                             -5.59448269671584874629,  3.61872723115328120969,
                             2.77097128182063956459,   -3.94010217753228220161,
                             6.21853306171658903878,   2.60759432099278765094,
                             4.02935567872375433041,   32.18331851157552137010,
                             -8.27157962269713387116,  4.91822698265419688823,
                             32.93167093429986636011,  -6.78108551581040774892,
                             4.81217386621111664624,   30.51742152436708011010,
                             -8.70015036556766752085,  -8.75950723481935433767,
                             14.71677474644589445063,  -4.57521774377949608237,
                             -10.18001878388516701079, 13.66934237504653282258,
                             -5.25100123399165319427,  -7.40182266047088610605,
                             14.85481749962677788801,  -5.88261220725769096163,
                             13.09678568796451791911,  23.22365987183872348965,
                             -14.57647928764855649320, 13.05222349043892648979,
                             22.88051147347673719423,  -12.71855520931560334930,
                             11.74564820466497927498,  22.21902471195838302265,
                             -15.43479406701349709863, 1.49819368566661070830,
                             24.34420556826921711036,  -10.51091443883616172172,
                             0.36573148492848361890,   25.51452137942503384238,
                             -9.55232141608573748215,  3.26611243496977321499,
                             25.01132037106676619942,  -10.47771569815015269000,
                             5.56465976412429075282,   20.87880183757041407944,
                             -28.87707850114423280274, 4.03636512924786927670,
                             20.87236871594948084407,  -29.98873690655490165113,
                             7.12143704280420308805,   20.81565744542940876727,
                             -29.94663719322646144860, 1.44829771513123195525,
                             0.13112580478743374179,   -24.46552382284188453809,
                             1.20943066308626412386,   -0.51869788369486991009,
                             -26.22399686683283448474, 1.83056572753539925635,
                             1.98097844388550492489,   -24.52444786904949225459,
                             -11.89535724341761202538, 10.50541782806130974848,
                             -5.71914760089724438785,  -10.74353097356839192855,
                             9.68294519603081838000,   -4.46675165398345530576,
                             -13.66557662181085497366, 9.90875030471845796853,
                             -5.43283581863913855869,  4.30437938534743569363,
                             7.62309669543460799446,   -10.79329441755783314250,
                             3.16820118788231530615,   6.36540267245174984367,
                             -9.95764190431557061345,  4.64004217870391233447,
                             9.05459300007369982666,   -9.60592440714543549518,
                             14.25571691513425420794,  6.59803863357628905817,
                             -16.63803668715760508690, 12.88285241044111906206,
                             6.42300098076824887983,   -15.35106032575112067207,
                             13.89913794439289596028,  8.09172352539887462797,
                             -17.73961345636715236651, -2.17090368629022245628,
                             15.24619658450764170254,  -28.54848347528332297429,
                             -2.84610391230155768127,  13.66338690079122741849,
                             -27.76720207038476928574, -0.99072884875949418504,
                             14.79992870060489984496,  -29.95546930422146658657,
                             0.29832885783017737413,   9.55020771877840424224,
                             -22.62017583908598439280, -0.98562588699055364572,
                             9.98886087263807631587,   -21.30463090799486991500,
                             1.79964416442891450565,   10.68341362152928120111,
                             -22.43711690039438622080, -11.11513518161220481772,
                             15.95403212913637425174,  -18.59058407678338653568,
                             -12.01731819410141355320, 17.51724549630841920589,
                             -18.03023528989355028784, -10.68631792387047063642,
                             16.09815050540745318131,  -20.42549415412990398977,
                             3.38701606456818771207,   27.18544160082543115209,
                             -4.82455968418884939553,  2.10115749550717412220,
                             27.84364636029154382868,  -6.04318167645230275298,
                             2.58327109832815837720,   25.90266865339951962710,
                             -3.69311160537967486661,  8.42107854271822020564,
                             9.88332964206683151076,   -20.56028576449845957086,
                             8.97477093675651005356,   10.43976790374487073620,
                             -18.84112451977315672025, 9.92683281775284953596,
                             9.75246386369778051062,   -21.69486744510815867670,
                             -3.23591815214947509105,  22.63623560736766648915,
                             -12.05279609658016859441, -3.85217490556090336185,
                             23.02506751049270405929,  -13.79637338735432905423,
                             -1.43104106943423570186,  23.17163306417323553887,
                             -11.88915447950307857639, 9.35268641683217438754,
                             3.90682750762032382497,   -24.14936707377682978404,
                             9.60601267628789656783,   5.66056888337928576505,
                             -23.49231191075953617542, 10.38381227831141373485,
                             3.66589207391855698148,   -25.71468665493776484254,
                             16.10818967944562984940,  20.01181670783121546719,
                             -16.81393036734401036369, 14.80674033451945348361,
                             21.17747364303437151989,  -16.09352146824219431664,
                             17.51111860492803273814,  19.78729914565447600694,
                             -15.56777414740247778013, -2.89442557027233160483,
                             25.73649446215538461047,  -21.26981824606889759366,
                             -3.20024874474892584431,  24.22969286269055544381,
                             -22.36872150528084191023, -4.31842319299592247717,
                             26.96245091906866520048,  -21.47185108196312341988,
                             -5.22284687354137222570,  -1.27960306286932423703,
                             -20.53067210026134858936, -6.72497000058581928528,
                             -1.47675800346576147071,  -19.40092356621698144181,
                             -3.80363377471054597834,  -0.49534747352965241562,
                             -19.55993716658131731378, -1.27465332015564447588,
                             4.07678141718177489139,   -3.85776672077584770193,
                             -2.91683107920412298952,  4.74353199402090552894,
                             -4.51376199267919719915,  -1.45125725418905582309,
                             2.23466273099548962122,   -3.47437479331112841763,
                             -6.73645997463986745402,  11.19445461537443797795,
                             -14.27296715465713994320, -8.37905090357290838199,
                             11.38390039627572569714,  -15.18818412364860925834,
                             -7.00888827367781175326,  10.19817709386462389887,
                             -12.69031065220144327554, -3.41006389166573864458,
                             -0.54049183921448007428,  -9.34246970295383505345,
                             -4.49792050674916144004,  -1.85464904937289976061,
                             -10.15562936408801242294, -1.59290649442436671457,
                             -0.92060467480635022053,  -9.69616005608710018748,
                             7.84583016646604036737,   20.18399225589925549684,
                             -2.03349680730643989079,  6.56088458115148576155,
                             19.18676299234471827049,  -1.07117416289823630393,
                             9.06435200320497713733,   20.97401056735269619935,
                             -0.82408245256313772398,  11.67682516435899486851,
                             15.20390969373196377035,  -8.81133065118098990354,
                             12.06741302059613296649,  15.97958204910644219865,
                             -10.48981391859434886271, 12.80202918872135420258,
                             15.95672497103993592305,  -7.49273636231355766313,
                             3.06503415681331548015,   4.90834818973613629112,
                             -24.65697844010605876974, 2.18952788953412547102,
                             6.55240720968598289176,   -24.97647632077736190581,
                             4.08085111408848089098,   5.03431505904451537248,
                             -23.06834898342143347350, 8.11863176215141635339,
                             22.11596783306908520217,  -8.86273073092746521695,
                             9.99738507153561073437,   22.24151826326540870582,
                             -9.02252244523099022899,  7.62523025377142271708,
                             20.30494704040425091307,  -8.64259822327879589920,
                             -3.25819799424389433540,  25.51606995390956100778,
                             -2.67012861481130636676,  -1.98987329381284938634,
                             24.19505261944490825954,  -2.20345124599141639621,
                             -3.90624974252471357516,  25.17882133955179568829,
                             -4.41305701117017967761,  20.51739427450550223853,
                             20.60578566339806627639,  -14.20850314734011554663,
                             21.44461648937878806009,  20.97005544458659187512,
                             -15.81448662734775290062, 21.25494745614416203239,
                             19.07024012759435649400,  -13.39015482532309775365,
                             9.11479983068047161510,   29.19394762055040004611,
                             -14.15597108339931864407, 8.53980836279732535843,
                             28.05993174306517445871,  -15.55419460785333285457,
                             8.88854653546922790497,   30.99714762735341722077,
                             -14.67453455082137026011, -10.43999501112104688616,
                             3.25882886066476862297,   -11.02841351759430565949,
                             -11.40980671873494678437, 1.68392295961464744103,
                             -11.41677950855763512550, -11.24996621168343047259,
                             4.15447317249237979553,   -9.57463674725092062090,
                             -5.17910661272126482402,  24.07388306748025641468,
                             -7.52061276283739132964,  -6.72418120968976840146,
                             23.05050497281627741586,  -7.15030428382186133973,
                             -4.16564100480558341388,  23.21893578141151337491,
                             -8.86732507270724212844,  -10.78861263811541348900,
                             18.54032406926226883570,  -12.78280779398953725945,
                             -11.80768610502724058620, 17.38574514765380740755,
                             -11.68760822938261156878, -11.94417544602278624666,
                             19.72477981847283601269,  -13.69535886858272455413,
                             6.33318889520897521095,   13.70491293083410511144,
                             -3.37918465844131565845,  6.97880843271721929000,
                             14.67187415552830209720,  -4.86904179508935719412,
                             6.49613573530217625063,   14.76405454129714556188,
                             -1.82253771422417010228,  13.42951171347205097106,
                             22.32121123933957562713,  -23.68456905723415673037,
                             13.45558263114232033786,  20.63163913019651118930,
                             -22.83824117450305379862, 11.70545223998775341556,
                             22.64706977060605197494,  -24.38670499662684321152,
                             -12.45356748309167294053, 6.03383775182972748041,
                             -14.75015242536996140643, -12.03486440264788548404,
                             7.85202051487498398075,   -14.44915585900369769945,
                             -11.38746415660545174831, 4.94842126547450078533,
                             -13.62900855479357709044, 8.21917112799687110680,
                             4.21183762710775422278,   -3.60761278362438631007,
                             9.11940269512847301314,   3.40111567585136898018,
                             -5.05790155278857778143,  8.31236663724991764468,
                             6.09133238972971202685,   -3.78031004748884358335,
                             -9.76092711890350983595,  21.43057874775358584429,
                             -8.54167690583680183636,  -11.32006957974363992037,
                             21.67415375195822946353,  -7.50177337639391339508,
                             -10.19688954735372199423, 20.48230779115494470943,
                             -10.11723260837111659782, 11.99835289515606184807,
                             16.44805335454866579425,  -14.10031350568903008025,
                             11.05869106178084138037,  17.75419700780646081739,
                             -15.09158565092587167555, 11.25278717706929754172,
                             14.74460076685116760586,  -14.43789268996952301904,
                             -3.37720668131835255465,  11.06910614028954320531,
                             -8.98190454233650292792,  -3.99202888636505859310,
                             10.75451931962273377508,  -10.74109409517042657001,
                             -2.05267630679338219934,  9.79523223798464393042,
                             -8.54079020819121126351,  12.18265028525427240425,
                             0.88214792026108435063,   -16.77571011211749762992,
                             10.56429300593185161006,  0.20859672661510206271,
                             -16.06948410456237041899, 12.41612107102160500460,
                             2.67261345447742426629,   -16.21784739321626389597,
                             2.12644833392229815061,   -2.15944496831873511411,
                             -9.12364252414598553287,  3.81059717259064534289,
                             -1.32186720133339918881,  -8.93995474104127829662,
                             1.76654988784470967644,   -3.19396721701813079974,
                             -7.58357368139582899147,  -2.73736500263617354989,
                             10.40573413054611151551,  -26.45389404679341893711,
                             -1.42971519926225809627,  9.69291446907178588788,
                             -25.29050824204378145055, -4.45229146391472507815,
                             10.16270964157550338314,  -25.69791763436430898082,
                             13.02457536892192990763,  9.76955891884945692993,
                             -1.02351120702525144601,  14.04395616211588837530,
                             9.14112414182778110217,   0.43855226134166347407,
                             14.04828378784414333325,  9.63960604863779124685,
                             -2.60679736647662974036,  9.66232810571887945628,
                             15.64151983173871762745,  -28.19620580637480955488,
                             10.77952694467068717188,  15.29374507962364226898,
                             -26.71210311483681465461, 9.14611256725065580042,
                             14.00706092668426627768,  -28.99224754666208170306,
                             6.56088688661827657000,   2.39715118003994920315,
                             -12.08689808891921124712, 7.00627328852160946582,
                             1.00188001368162304949,   -13.28124374264188389816,
                             5.33427276695699159603,   3.57002987658193804421,
                             -12.91836939247170867873, 17.02461809564663397509,
                             14.98138964845410825433,  -3.82024927387245227806,
                             17.52361880807366745216,  14.77655980891081632933,
                             -2.00916156597887196611,  18.47815672260887964740,
                             15.68950627105864192856,  -4.79841419789597889434,
                             -6.67555235771774579945,  6.76685322680312939525,
                             -11.53723939249061025691, -5.93901377043976186343,
                             6.63428807374470164149,   -9.80182908554226983711,
                             -8.05829036409367915894,  5.49353120033561559410,
                             -11.73314932432815460572, -4.60353584906374102559,
                             17.00287366986849235673,  -23.87104647405311297348,
                             -3.68721427802040091493,  16.72210757459224339527,
                             -25.49987898189075252731, -3.45949198472345642585,
                             16.58730912341239260854,  -22.42536614403120509564,
                             4.21409074846412412541,   12.75785961974915672101,
                             -22.25296244923721289410, 4.75708604115447108995,
                             14.42071282387556507842,  -22.96832042964830833398,
                             5.73210079047275211650,   11.66797449624605675922,
                             -21.97110669964870055537, 5.00732813406478349805,
                             17.41162335097708080411,  -24.64498192476241200666,
                             6.48885081929108675780,   17.34199936883122106224,
                             -25.81599338217647954252, 3.49885522235471313479,
                             18.06548381732388008913,  -25.57663970656321339447,
                             3.73328976882971108608,   4.42979795040222779079,
                             -1.46897217755117948101,  2.69173310631414430816,
                             4.92573259986734068860,   -2.96590305323172298557,
                             5.54865545932646320182,   4.30381632232693345230,
                             -1.97905345470419158360,  8.62592916925716579613,
                             9.52923243073678349901,   -4.48861101295030362479,
                             10.05638327062589709726,  9.53674137386923348458,
                             -3.25356239972637117930,  7.54255260527195936504,
                             11.05180527498360554262,  -4.20639710342664585596,
                             13.67297524268817277004,  21.82197253470955899957,
                             -9.53302751253361435602,  14.12533930990953834339,
                             20.26008626603196915994,  -8.57027712844662481473,
                             13.79791500764394562850,  23.32320244455068802836,
                             -8.39179391772507798919,  -5.91940675804126215098,
                             21.99151648692214422454,  -23.13011616151117522122,
                             -6.01780725541738270579,  22.56187171778062960925,
                             -24.92919618577527174352, -5.61441957983812933719,
                             20.12717315756353642087,  -23.07658218327705768047,
                             5.30958274830538723421,   0.31468654155414849116,
                             -20.27466229635830785583, 5.34030139253973601399,
                             2.20406882763234168721,   -20.30636314503465555958,
                             4.52700703167371187874,   -0.32899840696024273967,
                             -21.86994238222749586953, 2.85887920298879194547,
                             6.45246456289672298823,   -15.65931285751270607420,
                             0.99591087670099032181,   6.51074593189046257891,
                             -15.97155087995132483059, 3.26216369948051410077,
                             7.40438802139926544044,   -14.07730717699371325580,
                             -7.13832636339070614184,  19.05463438509232076967,
                             -2.09913225631500077739,  -5.38825183256264583775,
                             18.85026868136748134930,  -1.41577632814729881261,
                             -7.72297573401716697106,  17.41440740999703251646,
                             -2.83352944288962138586,  -0.23228039011521861568,
                             19.05570109812028789520,  -6.08028946836314343471,
                             -1.87496633451567951134,  18.18360911377478572604,
                             -6.41504863212120657323,  0.37117108264342490997,
                             19.89090580278432085493,  -7.66436324707990390692,
                             5.40181009378714449554,   5.56390942917020048242,
                             -20.12814846450242711740, 6.56843012829355732407,
                             7.02745153322990123712,   -20.39035035536313955618,
                             4.48599255069664781814,   5.77484635575620153247,
                             -18.48848513824297512542, -10.31915310000245611377,
                             4.52365705614567570336,   -5.51373704828441280057,
                             -10.06792307677771880492, 5.35451291344861868282,
                             -3.83517004707310249501,  -11.93302361969624847404,
                             3.54077733915117276453,   -5.49425073274160347125,
                             14.28296953571300242913,  10.94903922506080107269,
                             -19.21795397381216474741, 15.00104261901027413728,
                             12.25533806268979830634,  -18.05621903446295561935,
                             14.73900252656483544911,  11.37427771804141052314,
                             -21.00201688659938170645, -2.27096009463752324109,
                             17.66064065520610171234,  0.61732169009613002686,
                             -1.25281221595043490424,  18.88147400586193214167,
                             1.63931393465702357481,   -1.12485557762337196053,
                             16.69166660682531500015,  -0.53117631718687718934,
                             -10.08813191049498136920, 15.87981068716138288721,
                             -23.89194878084270357022, -10.88356608469377917459,
                             16.49613923129690107316,  -25.49161921247522499812,
                             -8.22766939984164125121,  16.20715906020102892171,
                             -23.94715798305671583535, -9.03627708687264075138,
                             -0.58858177887550477969,  -16.35525712568762557453,
                             -7.88971446226877404229,  -1.32341273335765530206,
                             -15.04489097220778681674, -10.62761747014704383218,
                             -1.60446540571491214067,  -16.44043883237555903065,
                             -1.07317443879836393883,  15.74433696097902846134,
                             -20.46513408557061808324, -2.19140323559036387380,
                             15.01547181755820759008,  -19.12724965370755469962,
                             0.66964134873586045327,   15.03641361963955347392,
                             -20.28338225206310951876, -0.71475670711312278005,
                             10.76682501318084561603,  0.53451803460845714877,
                             -1.88240632151435383079,  9.41784848925784601192,
                             -0.08869510579636008529,  -0.32254708726947717290,
                             11.96123193184888933160,  -0.87653839830529378663,
                             -0.51401686014320502327,  28.79354446621829666242,
                             -8.36419080950230409144,  -2.21713772518458496208,
                             28.55235607367666972323,  -7.58131829236720822252,
                             -0.66517981696105787925,  29.93900466195620424514,
                             -9.85975845511048554215,  12.28984836831532767576,
                             9.05455359926829750350,   -24.26901339249438294132,
                             13.85591541204549592692,  8.28945010837583673435,
                             -23.53847992259678889582, 12.34913117917067282292,
                             8.93113464870922157957,   -26.15391479599453816718,
                             4.30424782256220517240,   8.70920992408967187259,
                             3.87244182948238435671,   3.10626421783259631937,
                             9.10758525030377441567,   2.46609287629658835428,
                             6.05927190713126240240,   8.57282330864720165664,
                             3.18472526205787431763,   13.73980751242022968484,
                             19.20120776224212022498,  -4.93829295301950388364,
                             13.27701147253187485830,  20.18103677975422272084,
                             -3.39014399718809444906,  15.04514119094367252671,
                             17.90751249581897752705,  -4.49764848056510579966,
                             8.63591397585306985718,   10.71782843925567441090,
                             -29.86131181060401473815, 10.32794119925847020625,
                             9.87620025057778327948,   -29.87725331977769371861,
                             7.29136515759377257240,   9.42281306632752269081,
                             -29.56692571672616409728, 14.71703362013088067783,
                             5.91228207197213606605,   -7.73269151909475205287,
                             14.35169895894946279213,  7.62493150684931375594,
                             -7.02207686653048490655,  15.30766433537360882156,
                             6.08501841538842214163,   -9.51956664783239503436,
                             -7.30783900282891973887,  12.59463580238747937301,
                             -0.13732008382828861381,  -7.36909262874237303009,
                             13.85326442759227916213,  1.27115333810803732284,
                             -7.40690619584752063531,  13.49858361191056843609,
                             -1.79404305175772971204,  5.99266721720709671928,
                             16.40219489887126513850,  1.55659614835867854410,
                             7.07755875633294628813,   17.67145788649166249229,
                             2.44176555292463604019,   5.34832804524762028819,
                             15.14211989561148641315,  2.80900893273895224667,
                             -2.03768640738354678277,  5.72138114468315794880,
                             -15.54088652757017641193, -3.25739580518427906952,
                             5.69638119192632963461,   -14.09755784926405297597,
                             -2.92969118083363655458,  6.28340339810687087407,
                             -17.10931346222530535783, 6.04206433764128014730,
                             26.85937814757632935425,  -10.50766692429943383047,
                             6.57681560234099293893,   25.22843918008530295083,
                             -9.71670099040586343619,  7.43076993142181141394,
                             27.50804706175816249925,  -11.61322600944485827767,
                             -11.70330511341196277897, 11.54458510101535040349,
                             -15.57640048603775539959, -12.84847124875041934899,
                             11.54770883844157935982,  -14.07298032605347870572,
                             -11.87456692184278850277, 13.18361419714008597737,
                             -16.50155632236473479679, -5.61443088040486060208,
                             3.92798063785841122808,   -7.40109566364374060754,
                             -5.40727493825317573339,  2.11303575174280178217,
                             -7.88563444745331221242,  -7.40317791589581908340,
                             4.23922060104653120050,   -6.87649295037388252894,
                             -3.51662500448810355635,  3.79366775199980343913,
                             -23.18342101036137137271, -3.64247769649853170293,
                             3.23142976735572373670,   -24.98331745332847475538,
                             -4.40426688990640702315,  2.54956252822779472211,
                             -22.07172140890477507469, 20.12833649232676336283,
                             16.15854131982304409121,  -19.38029402260491096399,
                             20.45181621650222680842,  17.02361230741320952120,
                             -21.02911541884851587270, 21.76128505207142183053,
                             15.52464394711032369401,  -18.67092915980854073155,
                             5.47884583041212991361,   13.43334897397278915321,
                             5.61971616302295906564,   4.72243963739920680212,
                             11.81932740840966289397,  4.99218580928498489868,
                             7.32825224830255272934,   13.18691575786551517524,
                             5.91970333177745899889,   13.78604555753556937248,
                             21.47917335787458625873,  -0.36044255513751133346,
                             14.26699257526309594368,  20.11575198846510659223,
                             0.85668938748282641438,   13.38244776322478202246,
                             23.06033965950901176711,  0.59279305411988048036,
                             -0.53629621090863777155,  6.26116078363194095147,
                             -8.69570092804487693172,  -0.27429141856128030907,
                             6.02156554423189138703,   -6.83949279730601045202,
                             -1.83764241454182908342,  5.03666716429474359273,
                             -9.31104414968905302885,  7.82791326909521689714,
                             0.17522998920965926484,   -7.84280299408326619925,
                             7.41924289982368811991,   1.23236402942682654604,
                             -9.35508997934528530038,  9.65161700149477397304,
                             0.39223284458697155186,   -7.39719755393752897987,
                             18.64769347496206464143,  21.90730787619265385047,
                             -21.29792542003904642911, 17.33971909209961737020,
                             22.45142528870302101041,  -22.54859043382460015437,
                             17.82072947236935789306,  21.55335751553828060878,
                             -19.63604096549925870363, 1.59305863633529032342,
                             20.35190541161085775457,  3.29044705268747561533,
                             1.81233046787747742457,   22.22102721773622135970,
                             3.46322755902089474134,   2.30334241662052541244,
                             19.49105019681505623907,  4.81555515451351823231,
                             8.72799932725723159876,   26.21861277039629101182,
                             -3.68773234664394022886,  6.98119632939451228992,
                             26.81587686161718764311,  -4.09143878135293448395,
                             8.63224597818877192879,   24.57951008830693595542,
                             -2.75221965429337123155,  11.89432960994147414624,
                             29.09759876185094995549,  -20.99659104609610693615,
                             13.29306026150040587197,  28.21143645698887070239,
                             -21.90757621740929650400, 11.76090910980635939609,
                             30.87509398556626294408,  -21.62455907947624567100,
                             1.45455015996538006284,   15.16990787581470634393,
                             -3.17971423550154863591,  1.06366215840824529515,
                             16.22922532536372486334,  -4.69522169330866834258,
                             3.27423871407865396677,   14.66116957086192407189,
                             -3.21968460458410321579,  2.80483809764974667544,
                             28.44383852661774625403,  -14.92737352530439132181,
                             3.03930847334634712809,   30.26329829149792871590,
                             -14.47331293688123388108, 4.20215723661459161775,
                             27.42098110840040092739,  -14.17053741942677724808,
                             8.92243045332658013535,   20.70650547926308249203,
                             3.06368568550787401250,   8.86564215753896966987,
                             22.46580641259918564856,  3.75158604776851678508,
                             9.95814345672619971594,   19.61614459812123101301,
                             4.20823217940311078422,   15.90369537980675751498,
                             13.55904147383578539632,  -23.80751540599836957313,
                             17.70577341796790094008,  13.15609565419510040840,
                             -23.40540922980401816744, 15.44628294502595622362,
                             12.80028357241527814381,  -25.47682367147476512059,
                             2.49084391422907680536,   27.06593268414915698372,
                             -19.98193222683525860361, 2.68680095695769072250,
                             27.23889902622373782037,  -18.11038372793980144593,
                             0.68119959862201118206,   26.71082853185228955795,
                             -20.39521540051816472783, 5.59249765201435433681,
                             7.12962772380507825432,   -28.81652356394930336592,
                             5.73200809936939759126,   5.63394401117206466978,
                             -27.66979978343730195434, 4.70276984827382893428,
                             6.62402795283997569697,   -30.40531793709855179486,
                             7.64325365614907692446,   27.29314299374311403312,
                             -18.37676886939530618292, 9.18612696696946429142,
                             27.91556180635212669472,  -19.27329914187502524214,
                             6.22001286904003780620,   27.13354080014815039590,
                             -19.60985156195375722632, -2.46554874833940651513,
                             28.87856628311510220897,  -16.44617940689032664636,
                             -1.03086010918842485573,  28.84416097071490270309,
                             -15.21674398169233022315, -2.04486818210164367215,
                             27.79328922080891572932,  -17.93487409694677481298,
                             1.92750085510141211387,   -3.49580486302314907832,
                             -17.42745421664207228218, 0.89995557252110347513,
                             -1.92120865041376354121,  -17.61826564646612069964,
                             3.26009673511887276831,   -3.54405121537784806307,
                             -18.76664407183230309784, -2.51221785905283523377,
                             -0.86404836189026112958,  -3.83986127514990371878,
                             -1.45203160757175875339,  -2.37522261927484246158,
                             -3.43495716934032024881,  -2.74218110386506008780,
                             -0.73958363647702463073,  -5.71154598555871029220,
                             -4.09318063710252832976,  15.85255222732658353380,
                             -7.57867021809338048399,  -4.79354191508701887869,
                             16.70000888171632524859,  -9.11582256976399563086,
                             -3.39176360650595443147,  14.16366966062394894266,
                             -8.05532356848465092014,  -5.34543612061749406905,
                             18.16123641050158710186,  -12.04017823903911121874,
                             -4.49234018107363741734,  19.84729372213833897831,
                             -12.06168724264282765546, -7.14486032083783317859,
                             18.35934796863809026490,  -12.58224340816022035483,
                             9.09411735581856284227,   8.68072716690256740435,
                             2.63010159171694901659,   9.91828520513930023128,
                             7.00625841637108148774,   2.92773247892482091359,
                             10.19069978476010795987,  9.73091016805341091356,
                             1.50480576442286784200,   16.00302452676514519680,
                             27.22932748399873759126,  -16.50892525563280699430,
                             15.08766017797447567261,  25.80306273704261244006,
                             -15.67260351451405142598, 14.83882039468835500884,
                             28.10454700412149264821,  -17.71316867513138859636,
                             -6.29149541646746435219,  18.32727070526496859770,
                             -17.73268282635111248169, -8.00575950957808402109,
                             17.53406652216555272616,  -17.78881695538544249757,
                             -5.09468822341107863139,  17.17633738805730203580,
                             -16.83045483836221833940, 10.02146147697273192989,
                             19.89495029073447796009,  -17.38332871610066732160,
                             8.48205237567014513900,   20.44236726085978617107,
                             -18.33317020581015910352, 11.22125880376509066139,
                             19.04077928556985455089,  -18.56759842170011154394,
                             9.21992926752296426685,   10.29736813958278673908,
                             -9.58535563714976568406,  9.01624860868858668539,
                             9.49387987384183240636,   -7.88694312111070594540,
                             10.10765116397726970376,  11.95490508846756227967,
                             -9.39520461017769292766,  1.08569304788378917515,
                             21.66078692006644246248,  -18.64711368785869893827,
                             -0.17429497124780546358,  22.53102973107296591593,
                             -17.53948935800308817079, 0.92315522027601337740,
                             19.78976627857975501001,  -18.43600213161192158395,
                             13.18665510783726269040,  25.68152175926013214280,
                             -5.64378313872296732967,  11.33339884386509588410,
                             25.93824399019609572292,  -5.37699488072989240095,
                             13.97411355746753791607,  27.30771267458714035570,
                             -6.19787163841210198001,  7.58027860243359086212,
                             -0.96805227740435029204,  -15.72950961587522122898,
                             7.29504536289370175695,   -2.65941325870172118329,
                             -14.93600058203588432093, 6.38848899328580088763,
                             -0.74374999291352517083,  -17.17900016440624355596,
                             -3.54894942523957812597,  14.26060681019771969602,
                             -16.10096874958662382937, -4.61671899950300979043,
                             12.76788307125971044798,  -15.65012627154997737478,
                             -3.03003031121912558277,  15.16285630327848643617,
                             -14.52354754647311274596, -5.12938453485318657243,
                             6.88364603903797700468,   -19.60765286473145962987,
                             -4.07743403435902074250,  5.97612622997598119667,
                             -20.88882500562193911264, -6.61963894878273340083,
                             5.81667256891361450499,   -19.14686462185620641208,
                             -8.25176283171793478743,  7.53525391315193182606,
                             -1.45532528813611139462,  -7.41519642766031061853,
                             6.51888018564676841038,   -0.09954085306051492499,
                             -8.43816613344873722724,  9.32440376282415783749,
                             -0.87634128089467888678,  8.40555207425870776206,
                             11.29341445300910606875,  -14.99336059579309043954,
                             8.81067920563440942772,   10.70422469230521933525,
                             -13.24396196357741040117, 6.59895639833174829647,
                             11.84295436120617317499,  -15.06995054584760751482,
                             7.41647342949523480371,   17.50474313887413657653,
                             -6.52968118417845122536,  7.78262520857860362611,
                             18.67461531774812399931,  -5.09133348577130462331,
                             9.04254954391441678752,   16.91034461059343030342,
                             -7.28737465914052151561,  6.09768701209614150116,
                             20.17260865457115315280,  -20.66631253814886193254,
                             4.63501350209854123818,   21.16456847141882491314,
                             -19.99726331643287480233, 5.49172086088397648496,
                             18.98076269376786839871,  -22.00172203251464253526,
                             -9.24729451582362749207,  4.27236142160373510990,
                             -18.55152468833679790805, -8.91892317693324443439,
                             2.59909997977992190954,   -17.73673632829847335302,
                             -10.47573494312867659062, 5.25317697103237524203,
                             -17.50249340012888765727, 18.63396122658392073390,
                             24.42313513247930245598,  -10.40585460063457290403,
                             17.84815993514457233005,  23.17462455851255498374,
                             -11.58712880567371605878, 19.15023734969584978671,
                             23.54497735162336979897,  -8.81402757489460420004,
                             -1.20064377325545112996,  0.77600014739869527247,
                             -18.90872906418836052467, -1.23228388610994765706,
                             2.42226791791782192220,   -17.98146108013008870330,
                             -0.61701765193877233795,  1.06400605090546140907,
                             -20.68283262500071373324, 0.72387524401098291005,
                             22.14761922759303658381,  -2.34749286155672232113,
                             0.41726282510388762459,   20.82322625510934699378,
                             -3.66033261082776162354,  1.37521883982108072964,
                             21.33294377873565750292,  -0.77153258739514696263,
                             -4.14325972217235616313,  23.03364431938651790688,
                             -17.00229915510311684557, -4.86696967177334283150,
                             21.43489265406470423159,  -17.70368782089925119294,
                             -4.08548179531612731807,  24.34717077650767080854,
                             -18.35986635851520532015, 8.55692511201356076356,
                             22.52022058781844293662,  -24.91367032202835929411,
                             7.80692960956352965951,   21.59281994493335687935,
                             -26.37943291186124739056, 7.68976612740160625492,
                             21.98744471131587019386,  -23.32144059549073489279,
                             16.97751465010762217389,  14.13593557543128298448,
                             -15.64112828032964408465, 15.42988869508690186194,
                             14.89744250033542449785,  -14.86879148186713095470,
                             17.89758532589285167091,  15.45286669677631330444,
                             -16.63645506134998441894, 14.50722981157533197916,
                             10.89344552011897704347,  -6.10015580798107936999,
                             13.57561366045765360866,  11.45167650899415257015,
                             -7.64680838358432080071,  15.70880599496954665995,
                             12.25042732393887057185,  -5.56494745614416697066};

  int numbers[378] = {
      8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1,
      8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1,
      8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1,
      8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1,
      8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1,
      8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1,
      8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1,
      8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1,
      8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1,
      8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1,
      8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1,
      8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1,
      8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1,
      8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1,
      8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1,
      8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1, 8, 1, 1};

  // results will live in here
  double energy = 0.0;
  double grad[3 * 12] = {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                         0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                         0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                         0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0};
  double pcgrad[3 * 378] = {
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0};

  xtb_TEnvironment env = xtb_newEnvironment();
  xtb_TCalculator calc = xtb_newCalculator();
  xtb_TResults res = xtb_newResults();
  xtb_TMolecule mol =
      xtb_newMolecule(env, &natoms, attyp, coord, &charge, &uhf, NULL, NULL);
  if (xtb_checkEnvironment(env)) goto error;

  xtb_setVerbosity(env, XTB_VERBOSITY_FULL);
  if (xtb_checkEnvironment(env)) goto error;

  xtb_loadGFN2xTB(env, mol, calc, NULL);
  if (xtb_checkEnvironment(env)) goto error;

  xtb_setExternalCharges(env, calc, &npc, numbers, pc, pccoord);
  if (xtb_checkEnvironment(env)) goto error;

  xtb_singlepoint(env, mol, calc, res);
  if (xtb_checkEnvironment(env)) goto error;

  xtb_getEnergy(env, res, &energy);
  if (xtb_checkEnvironment(env)) goto error;

  xtb_getGradient(env, res, grad);
  if (xtb_checkEnvironment(env)) goto error;

  xtb_getPCGradient(env, res, pcgrad);
  if (xtb_checkEnvironment(env)) goto error;

  xtb_releaseExternalCharges(env, calc);
  if (xtb_checkEnvironment(env)) goto error;

  xtb_delete(res);
  xtb_delete(calc);
  xtb_delete(mol);
  xtb_delete(env);

  if (!check(energy, -15.869524505198, 1.0e-9, "Energy does not match"))
    goto error;

  if (!check(grad[0], 0.010921727277, 1.0e-8, "grad[0] does not match"))
    goto error;
  if (!check(grad[35], 0.004567073795, 1.0e-8, "grad[1133] does not match"))
    goto error;

  if (!check(pcgrad[0], -0.000004104685, 1.0e-8, "pcgrad[0] does not match"))
    goto error;
  if (!check(pcgrad[1133], -0.000001841411, 1.0e-8, "pcgrad[1133] does not match"))
    goto error;

  return 0;

error:
  xtb_showEnvironment(env, NULL);
  xtb_delete(res);
  xtb_delete(calc);
  xtb_delete(mol);
  xtb_delete(env);
  return 1;
}

int main(int argc, char **argv) {
  int stat = 0;
  stat += simpleTest();
  stat += smallEmbeddingTestGFN1();
  stat += bigEmbeddingTestGFN2();
  return stat > 0 ? EXIT_FAILURE : EXIT_SUCCESS;
}
